---
layout: post
title: Don't Use Rails' Scaffolded Controllers
date: 2010-11-12 22:04:28.000000000 -05:00
categories:
- coding
- rails
- ruby
tags: []
status: publish
type: post
published: true
---
<p>Fellow Rails Developers, the state of the art has moved on, and you should no longer be using the controllers generated by Rails' scaffold command (or 'rails g resource foo').</p>
<p>These controllers are all the same. Repetition like that can and should be eliminated.</p>
<p>Instead, you should use something like <a href="https://github.com/josevalim/inherited_resources">Inherited Resources</a>. </p>
<p>Here's what a controller generated by Rails looks like:</p>
<p><code lang="ruby">class UsersController < ApplicationController<br />
  # GET /users<br />
  # GET /users.xml<br />
  def index<br />
    @users = User.all</p>
<p>    respond_to do |format|<br />
      format.html # index.html.erb<br />
      format.xml  { render :xml => @users }<br />
    end<br />
  end</p>
<p>  # GET /users/1<br />
  # GET /users/1.xml<br />
  def show<br />
    @user = User.find(params[:id])</p>
<p>    respond_to do |format|<br />
      format.html # show.html.erb<br />
      format.xml  { render :xml => @user }<br />
    end<br />
  end</p>
<p>  # GET /users/new<br />
  # GET /users/new.xml<br />
  def new<br />
    @user = User.new</p>
<p>    respond_to do |format|<br />
      format.html # new.html.erb<br />
      format.xml  { render :xml => @user }<br />
    end<br />
  end</p>
<p>  # GET /users/1/edit<br />
  def edit<br />
    @user = User.find(params[:id])<br />
  end</p>
<p>  # POST /users<br />
  # POST /users.xml<br />
  def create<br />
    @user = User.new(params[:user])</p>
<p>    respond_to do |format|<br />
      if @user.save<br />
        format.html { redirect_to(@user, :notice => 'User was successfully created.') }<br />
        format.xml  { render :xml => @user, :status => :created, :location => @user }<br />
      else<br />
        format.html { render :action => "new" }<br />
        format.xml  { render :xml => @user.errors, :status => :unprocessable_entity }<br />
      end<br />
    end<br />
  end</p>
<p>  # PUT /users/1<br />
  # PUT /users/1.xml<br />
  def update<br />
    @user = User.find(params[:id])</p>
<p>    respond_to do |format|<br />
      if @user.update_attributes(params[:user])<br />
        format.html { redirect_to(@user, :notice => 'User was successfully updated.') }<br />
        format.xml  { head :ok }<br />
      else<br />
        format.html { render :action => "edit" }<br />
        format.xml  { render :xml => @user.errors, :status => :unprocessable_entity }<br />
      end<br />
    end<br />
  end</p>
<p>  # DELETE /users/1<br />
  # DELETE /users/1.xml<br />
  def destroy<br />
    @user = User.find(params[:id])<br />
    @user.destroy</p>
<p>    respond_to do |format|<br />
      format.html { redirect_to(users_url) }<br />
      format.xml  { head :ok }<br />
    end<br />
  end<br />
end<br />
</code></p>
<p>Here's that SAME controller using Inherited Resources:</p>
<p><code lang="ruby">class UsersController < InheritedResources::Base<br />
end</code></p>
<p>That's right, just by inheriting from InheritedResources::Base you all the standard REST actions for free. </p>
<p>If you need to, you can override any of the default actions: </p>
<p><code lang="ruby"><br />
class UsersController < InheritedResources::Base<br />
  def new<br />
    # do different stuff for new<br />
  end<br />
end<br />
</code></p>
<p>It even has a nice DSL for customizations you're likely to need. Here's how to change just the redirect for the destroy action:</p>
<p><code lang="ruby"><br />
class UsersController < InheritedResources::Base<br />
  def destroy<br />
    destroy!{ root_url }<br />
  end<br />
end<br />
</code></p>
<p>The best thing is, once you've got that duplicated code out of there, you don't need to test it! Inherited Resources already has its own tests for the standard actions, so you only need test the things you explicitly change.</p>
<p>A few months ago, I refactored an app to use Inherited Resources instead of the generated controllers. And by 'refactored', I mean 'deleted pages and pages of controller and test code'. I 'git rm'd almost all our functional tests and damn that felt <em>good</em>.</p>
<p>You gotta get in on this! The <a href="https://github.com/josevalim/inherited_resources/blob/master/README.rdoc">README</a> is solid, so you should have little trouble getting started.</p>
